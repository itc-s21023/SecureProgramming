# 4-7  
## オープンリダイレクト脆弱性を利用した攻撃手法とその理屈  
- セキュリティ上の問題で、攻撃者が被害者を別のWebサイトに誘導することができる脆弱性のことで、この脆弱性を利用し、偽のWebサイトに誘導することができる  
	1. 攻撃者がオープンリダイレクト脆弱性が存在するWebアプリケーションのURLを特定する  
	1. 攻撃者が悪意のあるURLを用意し、そのURLをリダイレクト先として利用する  

	1. 被害者がそのURLをクリックすると、オープンリダイレクト脆弱性が悪用され、偽のWebサイトにリダイレクトされる  
## HTTPヘッダ・インジェクション脆弱性による攻撃手法とその理屈  
- 攻撃者がHTTPリクエスト、レスポンスのヘッダに不正データを挿入することで、改ざんしたり、脆弱性を悪用する攻撃  
	- 攻撃者がヘッダや、HTTPリクエストに"\n"といった改行文字を挿入し、ヘッダの終了を示すことで、ヘッダを追加したり、改ざんされる  
	- 攻撃者がヘッダや、HTTPリクエストに不正な文字列を挿入することで、アプリの挙動を誤動作させ、改ざんされる  
	- HTTPヘッダ・インジェクション脆弱性を利用し、不正なスクリプトを挿入することで、XSS攻撃を行う場合がある  
## 対策  
- 入力値を検証する  
- 許可されたリダイレクト先のURLのみを許可する  
- 特殊文字などの入力をエスケープする  
- リダイレクト先のURLを固定する  
- ドメインのチェックを行う  
- セッション変数を使ってURLを受け渡す  
